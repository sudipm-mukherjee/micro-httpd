#!/usr/bin/make -f

PACKAGE = micro-httpd
BIN	= micro_httpd

MANSECT = 8
MANSRC  = debian

include debian/debian-vars.mk

man:
	# target: man -- convert *.pod to manual page
	$(MAKE) -C $(MANSRC) -f pod2man.mk PACKAGE=$(PACKAGE) \
	MANSECT=$(MANSECT) makeman

install: build man
	# target: install
	dh_testdir
	dh_testroot
	dh_prep
	dh_installdirs
	dh_lintian

	# Installing package
	install -d -m 0755 $(SBINDIR) $(MAN8DIR)
	$(MAKE) install BINDIR=$(SBINDIR) MANDIR=$(MAN8DIR)

	# rename binary
	mv $(SBINDIR)/$(BIN) $(SBINDIR)/$(PACKAGE)

	# replace original manual page
	rm -f $(MAN8DIR)/*
	$(INSTALL_DATA) $(MANSRC)/*.8 $(MAN8DIR)

binary-arch: build install
	# target: binary-arch
	dh_testdir
	dh_testroot
	dh_installchangelogs
	dh_installdocs
	dh_install
	dh_installman
	dh_link
	dh_strip
	dh_compress
	dh_fixperms
	dh_installdeb
	dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb

binary: binary-indep binary-arch

%:
	dh $@

.PHONY: install man
.PHONY: binary-indep binary-arch binary

# End of file
